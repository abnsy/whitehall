<% page_title @world_location.title, "UK and the world" %>
<% page_class "world-locations-show govuk-width-container" %>
<% atom_discovery_link_tag atom_feed_url_for(@world_location), t("feeds.latest_activity") %>

<% if world_location_survey_url(@world_location) %>
  <% initialise_script('GOVUK.CustomUserSatisfactionSurvey', surveyUrl: world_location_survey_url(@world_location)) %>
<% end %>

<%= content_tag_for(:article, @world_location) do %>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <%= render "govuk_publishing_components/components/title", {
      context: t_world_location(@world_location),
      title: @world_location.title,
    } %>
  </div>
  <div class="govuk-grid-column-one-third">
    <aside class="heading-extra">
      <div class="inner-heading">
        <%= render 'shared/available_languages', object: @world_location %>
        <%= render 'shared/featured_links', links: @world_location.featured_links.only_the_initial_set %>
      </div>
    </aside>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <section class="featured-news items-<%= @feature_list.current_feature_count %>" id="featured-documents">
      <% if @feature_list.any_current_features? %>
        <%= render partial: 'shared/featured',
          collection: @feature_list.current_featured,
          as: :feature
        %>
      <% end %>
      <%= render partial: 'shared/recently_updated',
        locals: {
          recently_updated: @recently_updated,
          atom_url: atom_feed_url_for(@world_location),
          extra_class: 'panel',
          see_all_link: latest_path(world_locations: [@world_location]),
        } %>
      </section>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <section class="article-section govuk-!-margin-bottom-8">
      <%= render "govuk_publishing_components/components/heading", {
        text: t('world_location.headings.mission'),
        font_size: "l",
      } %>
      <!-- TODO remove keyline-header on page redesign -->
      <hr class="govuk-section-break govuk-section-break--visible keyline-header">
      <%= render "govuk_publishing_components/components/lead_paragraph", {
        text: @world_location.mission_statement
      } %>
    </section>
  </div>
</div>

<% if (@non_statistics_publications + @announcements + @statistics_publications).any? %>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full govuk-!-margin-bottom-2">
    <%= render "govuk_publishing_components/components/heading", {
      text: t('world_location.headings.documents'),
      font_size: "l",
    } %>
    <!-- TODO remove keyline-header on page redesign -->
    <hr class="govuk-section-break govuk-section-break--visible keyline-header">
  </div>
  <div class="govuk-grid-column-one-half">
    <% if @announcements.any? %>
      <section id="announcements" class="document-block documents-<%= document_block_counter %>">
        <%= render "govuk_publishing_components/components/heading", {
          text: t('world_location.headings.announcements'),
          heading_level: 3,
        } %>
        <div class="content">
          <%= render partial: "shared/list_description", locals: { editions: @announcements } %>
          <p class="see-all govuk-!-margin-top-2">
            <%= link_to t_see_all_our(:announcement), announcements_filter_path(@world_location, include_world_location_news: '1') %>
          </p>
        </div>
      </section>
    <% end %>
  </div>
  <div class="govuk-grid-column-one-half">
    <% if @non_statistics_publications.any? %>
      <section id="publications" class="document-block documents-<%= document_block_counter %>" >
        <%= render "govuk_publishing_components/components/heading", {
          text: t('world_location.headings.publications'),
          heading_level: 3,
        } %>
        <div class="content">
          <%= render partial: "shared/list_description", locals: { editions: @non_statistics_publications } %>
          <p class="see-all govuk-!-margin-top-2">
            <%= link_to t_see_all_our(:publication), publications_filter_path(@world_location) %>
          </p>
        </div>
      </section>
    <% end %>
    <% if @statistics_publications.any? %>
      <section id="statistics-publications" class="document-block documents-<%= document_block_counter %>">
        <%= render "govuk_publishing_components/components/heading", {
          text: t('world_location.headings.statistics'),
        } %>
        <div class="content">
          <%= render partial: "shared/list_description", 
            locals: { 
              editions: @statistics_publications 
          } %>
          <p class="see-all">
            <%= link_to t_see_all_our(:statistics), publications_filter_path(@world_location, publication_filter_option: 'statistics') %>
          </p>
        </div>
      </section>
    <% end %>
  </div>
</div>
<% end %>

<div class="govuk-grid-row govuk-!-margin-top-9 world-organisations">
  <%= render "govuk_publishing_components/components/heading", {
    text: t('world_location.headings.organisations'),
  } %>
  <hr class="govuk-section-break govuk-section-break--visible keyline-header">
  <section id="organisations" class="world-organisations-block">
      <%= render partial: 'worldwide_organisations/worldwide_organisation', 
        collection: @worldwide_organisations 
      %>
  </section>
  </div>
</div>
<% end %>
